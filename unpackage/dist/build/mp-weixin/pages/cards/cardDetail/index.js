(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cards/cardDetail/index"],{1971:function(e,a,t){"use strict";t.r(a);var i=t("384d"),r=t("42fb");for(var n in r)"default"!==n&&function(e){t.d(a,e,function(){return r[e]})}(n);t("dafc");var o=t("2877"),d=Object(o["a"])(r["default"],i["a"],i["b"],!1,null,"131d4b36",null);a["default"]=d.exports},"384d":function(e,a,t){"use strict";var i=function(){var e=this,a=e.$createElement;e._self._c},r=[];t.d(a,"a",function(){return i}),t.d(a,"b",function(){return r})},"42fb":function(e,a,t){"use strict";t.r(a);var i=t("e533"),r=t.n(i);for(var n in i)"default"!==n&&function(e){t.d(a,e,function(){return i[e]})}(n);a["default"]=r.a},"5d5c":function(e,a,t){},dafc:function(e,a,t){"use strict";var i=t("5d5c"),r=t.n(i);r.a},e533:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=o(t("eaab")),r=t("2f62"),n=t("6110");function o(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};i.get||i.set?Object.defineProperty(a,t,i):a[t]=e[t]}return a.default=e,a}function d(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{},i=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.forEach(function(a){c(e,a,t[a])})}return e}function c(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var u=function(){return t.e("components/FooterMenu").then(t.bind(null,"19a9"))},s=function(){return t.e("components/floatBtnGroup").then(t.bind(null,"e3ac"))},l=function(){return t.e("components/NavBar").then(t.bind(null,"661f"))},h=function(){return t.e("components/SpinKit").then(t.bind(null,"14a4"))},g={Druid:{name:"德鲁伊",image:"/static/heroIcons/druid.png"},Hunter:{name:"猎人",image:"/static/heroIcons/hunter.png"},Mage:{name:"法师",image:"/static/heroIcons/mage.png"},Paladin:{name:"圣骑士",image:"/static/heroIcons/paladin.png"},Priest:{name:"牧师",image:"/static/heroIcons/priest.png"},Rogue:{name:"潜行者",image:"/static/heroIcons/rogue.png"},Shaman:{name:"萨满",image:"/static/heroIcons/shaman.png"},Warlock:{name:"术士",image:"/static/heroIcons/warlock.png"},Warrior:{name:"战士",image:"/static/heroIcons/warrior.png"},Neutral:{name:"中立",image:""}},f={name:"",ename:"",series:"",flavor:"",type:"",bgImg:null,cardImg:null,heroIcon:null},m={components:{FooterMenu:u,floatBtnGroup:s,NavBar:l,SpinKit:h},data:function(){return{cardId:null,cardHsId:null,cardDetail:Object.assign({},f),myAudio:null,showEnAudio:!1,showZhAudio:!1,selectedAudio:"",audioPlaying:!1,imageLoaded:!1}},computed:d({},(0,r.mapGetters)(["navHeight","fbiVersion","fbiKey","fbiFlag","card_resource"]),{getEnAudio:function(){if(this.cardDetail.audios)return this.cardDetail.audios.filter(function(e){return"en"===e.type})},getZhAudio:function(){if(this.cardDetail.audios)return this.cardDetail.audios.filter(function(e){return"zh"===e.type})},genEntourage:function(){var e=this;if(this.cardDetail.entourage){var a=this.cardDetail.entourage.map(function(a){var t=a.replace(/\'/g,"").replace(/"/g,"").replace("[","").replace("]","").trim(),r="";return r="fbi"===e.card_resource?e.genCardImage(t):(e.card_resource,i.default.genCardsImageURL(t)),{hsId:t,image:r}}),t=a.length%3;if(t)for(var r=0;r<3-t;r++)a.push({});return a}}}),methods:{imageLoad:function(e){this.imageLoaded=!0},genCardImage:function(e){return(0,i.getCardPicture)(this,e,!1,this.fbiFlag,this.fbiVersion,this.fbiKey)},initCardDetail:function(){var e=this;this.showEnAudio=!1,this.showZhAudio=!1,wx.showNavigationBarLoading(),(0,n.getCardDetail)({dbfId:parseInt(this.cardId),hsId:this.cardHsId}).then(function(a){e.cardDetail=a[0],e.cardDetail.bgImg=(0,i.genOrigImageURL)(e.cardDetail.hsId),"fbi"===e.card_resource?e.cardDetail.cardImg=e.genCardImage(e.cardDetail.hsId):(e.card_resource,e.cardDetail.cardImg=i.default.genCardsImageURL(e.cardDetail.hsId));var t=!0,r=!1,n=void 0;try{for(var o,d=e.$store.state.cards.series[Symbol.iterator]();!(t=(o=d.next()).done);t=!0){var c=o.value;e.cardDetail.set_id===c.id&&(e.cardDetail.series=c.name,"Standard"===c.mode?e.cardDetail.series+="（标准）":"Wild"===c.mode&&(e.cardDetail.series+="（狂野）"))}}catch(D){r=!0,n=D}finally{try{t||null==d.return||d.return()}finally{if(r)throw n}}g[e.cardDetail.cardClass]?e.cardDetail.type=g[e.cardDetail.cardClass].name+"-"+i.default.type[e.cardDetail.type].name:e.cardDetail.type=i.default.type[e.cardDetail.type].name,e.cardDetail.race&&(e.cardDetail.type+="-"+i.default.race[e.cardDetail.race].name),e.cardDetail.audios=[{type:"en",ename:"audio_play_en",cname:"出场",src:""!==e.cardDetail.audio_play_en?JSON.parse(e.cardDetail.audio_play_en):""},{type:"en",ename:"audio_attack_en",cname:"攻击",src:""!==e.cardDetail.audio_attack_en?JSON.parse(e.cardDetail.audio_attack_en):""},{type:"en",ename:"audio_trigger_en",cname:"触发",src:""!==e.cardDetail.audio_trigger_en?JSON.parse(e.cardDetail.audio_trigger_en):""},{type:"en",ename:"audio_death_en",cname:"阵亡",src:""!==e.cardDetail.audio_death_en?JSON.parse(e.cardDetail.audio_death_en):""},{type:"zh",ename:"audio_play_zh",cname:"出场",src:""!==e.cardDetail.audio_play_zh?JSON.parse(e.cardDetail.audio_play_zh):""},{type:"zh",ename:"audio_attack_zh",cname:"攻击",src:""!==e.cardDetail.audio_attack_zh?JSON.parse(e.cardDetail.audio_attack_zh):""},{type:"zh",ename:"audio_trigger_zh",cname:"触发",src:""!==e.cardDetail.audio_trigger_zh?JSON.parse(e.cardDetail.audio_trigger_zh):""},{type:"zh",ename:"audio_death_zh",cname:"阵亡",src:""!==e.cardDetail.audio_death_zh?JSON.parse(e.cardDetail.audio_death_zh):""}];var u=[],s=!0,l=!1,h=void 0;try{for(var f,m=e.cardDetail.audios[Symbol.iterator]();!(s=(f=m.next()).done);s=!0){var p=f.value;if(p.src)for(var y in p.src)if(p.src.hasOwnProperty(y)){var _=y>0?p.cname+y:p.cname;u.push({type:p.type,ename:p.ename,cname:_,src:p.src[y]})}}}catch(D){l=!0,h=D}finally{try{s||null==m.return||m.return()}finally{if(l)throw h}}e.cardDetail.audios=u,(e.cardDetail.audio_play_en||e.cardDetail.audio_attack_en||e.cardDetail.audio_trigger_en||e.cardDetail.audio_death_en)&&(e.showEnAudio=!0),(e.cardDetail.audio_play_zh||e.cardDetail.audio_attack_zh||e.cardDetail.audio_trigger_zh||e.cardDetail.audio_death_zh)&&(e.showZhAudio=!0),wx.stopPullDownRefresh(),wx.hideNavigationBarLoading()}).catch(function(e){console.log(e),wx.stopPullDownRefresh(),wx.hideNavigationBarLoading()})},previewCard:function(){this.cardDetail.cardImg&&wx.previewImage({urls:[this.cardDetail.cardImg]})},handleAudioPlay:function(e){this.selectedAudio=e.src,this.myAudio&&(this.audioPlaying&&this.myAudio.stop(),this.myAudio.autoplay=!0,this.myAudio.src=encodeURI(e.src),this.myAudio.play())},handleCopyBtn:function(e){wx.setClipboardData({data:e,success:function(e){wx.showToast({title:"复制成功"})}})},handleEntourageClick:function(e){e&&wx.navigateTo({url:"/pages/cards/cardDetail/index?hsId=".concat(e)})}},mounted:function(){var e=this;this.imageLoaded=!1,this.cardId=this.$root.$mp.query.id,this.cardHsId=this.$root.$mp.query.hsId,this.myAudio=wx.createInnerAudioContext(),this.myAudio.onPlay(function(){console.log("start"),e.audioPlaying=!0}),this.myAudio.onCanplay(function(){console.log("Canplay")}),this.myAudio.onEnded(function(){console.log("end"),e.selectedAudio=""}),this.myAudio.onWaiting(function(){console.log("waiting..."),e.audioPlaying=!0}),this.myAudio.onError(function(e){console.log(e.errMsg),console.log(e.errCode),console.log(e)}),this.initCardDetail()},onPullDownRefresh:function(){this.initCardDetail()},onUnload:function(){this.myAudio&&(this.myAudio.stop(),this.myAudio.destroy()),this.selectedAudio="",this.cardId=null,this.cardHsId=null,this.cardDetail=Object.assign({},f)},onShareAppMessage:function(e){return"button"===e.from?{title:this.cardDetail.name,path:"/pages/cards/cardDetail/main?id=".concat(this.cardDetail.dbfId)}:{title:"炉石传说情报站",path:"/pages/index/main"}}};a.default=m}},[["fd38","common/runtime","common/vendor"]]]);