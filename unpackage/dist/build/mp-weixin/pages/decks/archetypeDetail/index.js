(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/decks/archetypeDetail/index"],{"0099":function(e,t,a){"use strict";var n=a("c09e"),i=a.n(n);i.a},1585:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(a("a34a")),i=s(a("eaab")),c=a("2f62"),r=a("6110");function s(e){return e&&e.__esModule?e:{default:e}}function o(e,t,a,n,i,c,r){try{var s=e[c](r),o=s.value}catch(u){return void a(u)}s.done?t(o):Promise.resolve(o).then(n,i)}function u(e){return function(){var t=this,a=arguments;return new Promise(function(n,i){var c=e.apply(t,a);function r(e){o(c,n,i,r,s,"next",e)}function s(e){o(c,n,i,r,s,"throw",e)}r(void 0)})}}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){l(e,t,a[t])})}return e}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var p=function(){return a.e("components/DeckCards").then(a.bind(null,"6633"))},d=function(){return a.e("components/DeckTable").then(a.bind(null,"9edf"))},f=function(){return a.e("components/HeroesPanel").then(a.bind(null,"1616"))},m=function(){return a.e("components/NavBar").then(a.bind(null,"661f"))},g=function(){return a.e("components/load-more").then(a.bind(null,"e201"))},D={faction:"",archetype_name:"",game_count:"",win_rate:"",popularity:"",core_cards:[],pop_cards:[],best_matchup:[],worst_matchup:[],matchup:[]},k={show:!1,deck_id:"",cname:"",win_rate:"",game_count:""},b={show:!1,deck_id:"",cname:"",win_rate:"",game_count:""},y={show:!1,ename:"",cname:"",win_rate:"",game_count:"",image:""},w={components:{DeckCards:p,DeckTable:d,HeroesPanel:f,NavBar:m,loadMore:g},data:function(){return{archetypeId:"5bc4333d02eed116ab1d4a84",archetypeName:"",archetypeDetail:Object.assign({},D),bannerImg:null,factionIcons:[],updateDate:null,selectedFaction:{id:"Druid",name:"德鲁伊",data:[]},tableTitle:[{id:"games",name:"对局数"},{id:"popularity",name:"热度"},{id:"winrate",name:"胜率"}],factions:["Druid","Hunter","Mage","Paladin","Priest","Rogue","Shaman","Warlock","Warrior"],matchupDetail:{Druid:[],Hunter:[],Mage:[],Paladin:[],Priest:[],Rogue:[],Shaman:[],Warlock:[],Warrior:[]},popDeck:Object.assign({},k),bestDeck:Object.assign({},b),bestMatchup:Object.assign({},y),worstMatchup:Object.assign({},y)}},computed:h({},(0,c.mapGetters)(["decksName","navHeight","archetypeList"]),{detailLoaded:function(){return void 0!==this.archetypeDetail.update_time},genArchetypeName:function(){return this.getDeckCName(this.archetypeDetail.archetype)},genFactionIcon:function(){if(this.archetypeDetail.faction)return i.default.faction[this.archetypeDetail.faction].image},adsOpenFlag:function(){return i.default.adsOpenFlag}}),methods:{resetPageData:function(){this.archetypeDetail=Object.assign({},D),this.bannerImg=null,this.selectedFaction={id:"Druid",name:"德鲁伊",data:[]},this.matchupDetail={Druid:[],Hunter:[],Mage:[],Paladin:[],Priest:[],Rogue:[],Shaman:[],Warlock:[],Warrior:[]},this.popDeck=Object.assign({},k),this.bestDeck=Object.assign({},b),this.bestMatchup=Object.assign({},y),this.worstMatchup=Object.assign({},y)},getDeckCName:function(e){var t=!0,a=!1,n=void 0;try{for(var i,c=this.decksName[Symbol.iterator]();!(t=(i=c.next()).done);t=!0){var r=i.value;if(r.ename===e)return r.cname}}catch(s){a=!0,n=s}finally{try{t||null==c.return||c.return()}finally{if(a)throw n}}return e},genArchetypeDetail:function(){var e=u(n.default.mark(function e(){var t,a,c,s,o,u,h,l,p,d;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(wx.showLoading({title:"加载中",mask:!1}),t={},!this.archetypeId){e.next=6;break}t={recordID:this.archetypeId},e.next=12;break;case 6:if(!this.archetypeName){e.next=10;break}t={name:this.archetypeName},e.next=12;break;case 10:return wx.hideLoading(),e.abrupt("return");case 12:return e.next=14,(0,r.getArchetypeDetail)(t);case 14:if(a=e.sent,a){for(s in this.archetypeDetail=a,this.updateDate=this.archetypeDetail.update_time,this.bannerImg=i.default.faction[this.archetypeDetail.faction].bgImage.replace("256x","512x"),c=JSON.parse(this.archetypeDetail.matchup),c)c.hasOwnProperty(s)&&(this.matchupDetail[this.factions[s]]=c[s]);this.genTableData(this.matchupDetail[this.selectedFaction.id]),o=JSON.parse(this.archetypeDetail.pop_deck),o.length>0&&(this.popDeck.cname=this.getDeckCName(this.archetypeDetail.archetype),this.popDeck.deck_id=o[0],this.popDeck.win_rate=o[1],this.popDeck.game_count=o[2],this.popDeck.show=!0),u=JSON.parse(this.archetypeDetail.best_deck),u.length>0&&(this.bestDeck.cname=this.getDeckCName(this.archetypeDetail.archetype),this.bestDeck.deck_id=u[0],this.bestDeck.win_rate=u[1],this.bestDeck.game_count=u[2],this.bestDeck.show=!0),h=JSON.parse(this.archetypeDetail.best_matchup),h.length>0&&(this.bestMatchup.ename=h[0],this.bestMatchup.cname=this.getDeckCName(h[0]),this.bestMatchup.win_rate=parseFloat(h[1]).toFixed(2),this.bestMatchup.game_count=h[2],l=h[0].split(" "),l="Handlock"===h[0]?"Warlock":l[l.length-1],this.bestMatchup.image=i.default.faction[l].image,this.bestMatchup.faction=l,this.bestMatchup.show=!0),p=JSON.parse(this.archetypeDetail.worst_matchup),p.length>0&&(this.worstMatchup.ename=p[0],this.worstMatchup.cname=this.getDeckCName(p[0]),this.worstMatchup.win_rate=parseFloat(p[1]).toFixed(2),this.worstMatchup.game_count=p[2],d=p[0].split(" "),d="Handlock"===h[0]?"Warlock":d[d.length-1],this.worstMatchup.image=i.default.faction[d].image,this.worstMatchup.faction=d,this.worstMatchup.show=!0),wx.hideLoading()}else wx.hideLoading(),wx.showModal({title:"提示",content:"抱歉，暂无该卡组详情",showCancel:!1,success:function(e){wx.navigateBack()}});case 16:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),genFactionIcons:function(){for(var e in this.factionIcons=[],i.default.faction)i.default.faction.hasOwnProperty(e)&&this.factionIcons.push({id:e,name:i.default.faction[e].name,image:i.default.faction[e].image})},handleCardClick:function(e){wx.navigateTo({url:"/pages/cards/cardDetail/index?id=".concat(e.dbfId)})},genTableData:function(e){var t=this,a=[],n=!0,i=!1,c=void 0;try{for(var r,s=function(){var e=r.value,n=t.decksName.filter(function(a){return a.ename===e[0]&&a.faction===t.selectedFaction.id})[0],i={deckName:n?n.cname:e[0],ename:e[0],games:parseInt(e[3].replace(",","")),winrate:parseFloat(e[1].replace("%","")).toFixed(1),popularity:parseFloat(e[2].replace("%",""))};a.push(i)},o=e[Symbol.iterator]();!(n=(r=o.next()).done);n=!0)s()}catch(u){i=!0,c=u}finally{try{n||null==o.return||o.return()}finally{if(i)throw c}}this.selectedFaction.data=a},handleIconsClick:function(e){this.selectedFaction={id:e.id,name:e.name,data:[]},this.genTableData(this.matchupDetail[e.id])},handleDeckItemClick:function(e){wx.navigateTo({url:"/pages/decks/archetypeDetail/index?name=".concat(e.ename)})},handlePopDeckClick:function(){wx.navigateTo({url:"/pages/decks/deckDetail/index?deckID=".concat(this.popDeck.deck_id)})},handleBestDeckClick:function(){wx.navigateTo({url:"/pages/decks/deckDetail/index?deckID=".concat(this.bestDeck.deck_id)})},gotoDecks:function(){wx.navigateTo({url:"/pages/decks/decksList/index?id=".concat(this.archetypeDetail.faction,"&name=").concat(this.archetypeDetail.archetype)})},handleWorstMatchupClick:function(){wx.navigateTo({url:"/pages/decks/archetypeDetail/index?name=".concat(this.worstMatchup.ename)})},handleBestMatchupClick:function(){wx.navigateTo({url:"/pages/decks/archetypeDetail/index?name=".concat(this.bestMatchup.ename)})}},mounted:function(){var e=u(n.default.mark(function e(){return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.archetypeId=this.$root.$mp.query.id,this.archetypeName=this.$root.$mp.query.name,e.next=4,Promise.all([this.genFactionIcons(),this.genArchetypeDetail()]);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),onShareAppMessage:function(e){return{title:this.genArchetypeName,path:"/pages/decks/archetypeDetail/index?name=".concat(this.archetypeName)}},onPullDownRefresh:function(){this.genArchetypeDetail()}};t.default=w},"21e8":function(e,t,a){"use strict";a.r(t);var n=a("1585"),i=a.n(n);for(var c in n)"default"!==c&&function(e){a.d(t,e,function(){return n[e]})}(c);t["default"]=i.a},a6c0:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c},i=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return i})},c09e:function(e,t,a){},fc6a:function(e,t,a){"use strict";a.r(t);var n=a("a6c0"),i=a("21e8");for(var c in i)"default"!==c&&function(e){a.d(t,e,function(){return i[e]})}(c);a("0099");var r=a("2877"),s=Object(r["a"])(i["default"],n["a"],n["b"],!1,null,"435ff31c",null);t["default"]=s.exports}},[["2a4a","common/runtime","common/vendor"]]]);