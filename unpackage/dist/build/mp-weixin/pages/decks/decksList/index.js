(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/decks/decksList/index"],{"2c71":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i("2f62"),s=r(i("eaab")),c=i("6110");function r(e){return e&&e.__esModule?e:{default:e}}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){o(e,t,i[t])})}return e}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var d=function(){return i.e("components/DecksBoard").then(i.bind(null,"b0c6"))},l=function(){return i.e("components/load-more").then(i.bind(null,"e201"))},u=function(){return i.e("components/HeroesPanel").then(i.bind(null,"1616"))},h=function(){return i.e("components/NavBar").then(i.bind(null,"661f"))},f={faction:"Druid",archetype:"all",mode:"Standard",last_30_days:!1,order:"-game_count"},k=[{id:"game_count",name:"样本大小"},{id:"dust_cost",name:"合成花费"},{id:"win_rate",name:"总体胜率"}],m=[{id:"real_game_count",name:"样本大小"},{id:"dust_cost",name:"合成花费"},{id:"real_win_rate",name:"总体胜率"}],p={components:{NavBar:h,DecksBoard:d,HeroesPanel:u,loadMore:l},data:function(){return{selectedFaction:"",factionIcons:null,selectedDeckIndex:0,deckPickerList:[],decksName:[],deckList:[],orderFilter:Object.assign({},k),decksFilter:Object.assign({},f),page:0,more:!0,normalOrder:"/static/icons-v2/rank-normal.png",upOrder:"/static/icons-v2/rank-up.png",downOrder:"/static/icons-v2/rank-down.png",filterIcon:"/static/icons-v2/filter-active.png",tabList:{selectedItem:0,list:[{text:"当前赛季卡组",last_30_days:!1},{text:"最近30天卡组",last_30_days:!0}]}}},computed:a({},(0,n.mapGetters)(["navHeight"]),{pickerList:function(){return this.deckPickerList.map(function(e){return e.name})},genOrderFilter:function(){return this.decksFilter.last_30_days?m:k},timePickerList:function(){return this.tabList.list.map(function(e){return e.text})}}),methods:{genDeckList:function(e){var t=this;e&&(this.page=0,this.more=!0),wx.showNavigationBarLoading();var i=this.decksFilter.order.replace("-","");if(this.decksFilter.last_30_days)for(var n in k)k.hasOwnProperty(n)&&k[n].id===i&&(this.decksFilter.order=this.decksFilter.order.replace(i,m[n].id));else for(var r in m)m.hasOwnProperty(r)&&m[r].id===i&&(this.decksFilter.order=this.decksFilter.order.replace(i,k[r].id));(0,c.getDeckList)(this.decksFilter,12,this.page,this.decksFilter.order).then(function(i){if(e)t.deckList=s.default.translateDeckName(i.objects,t.$store.state.cards.decksName),wx.stopPullDownRefresh();else{var n=s.default.translateDeckName(i.objects,t.$store.state.cards.decksName);t.deckList=t.deckList.concat(n)}t.deckList.map(function(e){return e.win_rate=parseFloat(e.win_rate).toFixed(1),e.real_win_rate=parseFloat(e.real_win_rate).toFixed(1),e}),t.deckList.length>=i.meta.total_count&&(t.more=!1),wx.hideNavigationBarLoading(),wx.stopPullDownRefresh()}).catch(function(e){wx.hideNavigationBarLoading(),wx.stopPullDownRefresh(),console.log(e)})},genPickerList:function(){var e=this;this.selectedDeckIndex=0,this.deckPickerList=[{id:"all",name:"全部类型"}];var t=this.decksName.filter(function(t){if(t.mode===e.decksFilter.mode||"All"===t.mode)return!0}),i=!0,n=!1,s=void 0;try{for(var c,r=t[Symbol.iterator]();!(i=(c=r.next()).done);i=!0){var a=c.value;this.selectedFaction?a.faction===this.selectedFaction&&a.ename!==a.faction&&this.deckPickerList.push({id:a.ename,name:a.cname}):a.ename!==a.faction&&this.deckPickerList.push({id:a.ename,name:a.cname})}}catch(o){n=!0,s=o}finally{try{i||null==r.return||r.return()}finally{if(n)throw s}}this.deckPickerList.push({id:this.selectedFaction,name:"其他"})},genFactionIcons:function(){for(var e in this.factionIcons=[],s.default.faction)s.default.faction.hasOwnProperty(e)&&this.factionIcons.push({id:e,name:s.default.faction[e].name,image:s.default.faction[e].image})},handleIconsClick:function(e){this.selectedFaction===e.id?this.selectedFaction="":this.selectedFaction=e.id,this.decksFilter.faction=this.selectedFaction,this.decksFilter.archetype="all",this.genPickerList(),this.genDeckList(!0)},handlePickerChange:function(e){this.selectedDeckIndex=e.mp.detail.value,this.decksFilter.archetype=this.deckPickerList[this.selectedDeckIndex].id,this.genDeckList(!0)},handleOrderChange:function(e){this.decksFilter.order.indexOf(e.id)>=0?this.decksFilter.order="-"===this.decksFilter.order.split("")[0]?e.id:"-"+e.id:this.decksFilter.order="-"+e.id,this.genDeckList(!0)},handleDeckClick:function(e){wx.navigateTo({url:"/pages/decks/deckDetail/index?id=".concat(e.id,"&mode=").concat(this.decksFilter.mode)})},handleHeadTabClick:function(e){this.deckList=[],this.tabList.selectedItem=e.mp.detail.value,this.decksFilter.last_30_days=this.tabList.list[this.tabList.selectedItem].last_30_days,this.genDeckList(!0)}},mounted:function(){for(var e in console.log("mounted"),this.$root.$mp.query.name&&(this.decksFilter.archetype=this.$root.$mp.query.name),this.selectedFaction=this.$root.$mp.query.id,this.decksFilter.faction=this.$root.$mp.query.id,this.decksName=this.$store.state.cards.decksName,this.genFactionIcons(),this.genPickerList(),this.deckPickerList)this.deckPickerList.hasOwnProperty(e)&&this.deckPickerList[e].id===this.decksFilter.archetype&&(this.selectedDeckIndex=e);this.genDeckList(!0)},onUnload:function(){console.log("onUnload"),this.tabList.selectedItem=0,this.decksFilter=Object.assign({},f),this.selectedFaction="",this.selectedDeckIndex=0,this.deckList=[]},onPullDownRefresh:function(){this.genDeckList(!0)},onReachBottom:function(){if(!this.more)return!1;this.page+=1,this.genDeckList(!1)},onShareAppMessage:function(e){return{title:"炉石传说情报站",path:"/pages/index/index"}}};t.default=p},3660:function(e,t,i){"use strict";i.r(t);var n=i("2c71"),s=i.n(n);for(var c in n)"default"!==c&&function(e){i.d(t,e,function(){return n[e]})}(c);t["default"]=s.a},"6e53":function(e,t,i){},"781d":function(e,t,i){"use strict";i.r(t);var n=i("a30b"),s=i("3660");for(var c in s)"default"!==c&&function(e){i.d(t,e,function(){return s[e]})}(c);i("7ab0");var r=i("2877"),a=Object(r["a"])(s["default"],n["a"],n["b"],!1,null,"6c00d3b5",null);t["default"]=a.exports},"7ab0":function(e,t,i){"use strict";var n=i("6e53"),s=i.n(n);s.a},a30b:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c},s=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return s})}},[["f813","common/runtime","common/vendor"]]]);